# ì‘ì—…ì§€ì‹œì„œ: P3BA11

## ğŸ“‹ ê¸°ë³¸ ì •ë³´

- **ì‘ì—… ID**: P3BA11
- **ì—…ë¬´ëª…**: AI í‰ê°€ ì¡°íšŒ API (Mock â†’ Real)
- **Phase**: Phase 3
- **Area**: Backend APIs (BA)
- **ì„œë¸Œ ì—ì´ì „íŠ¸**: backend-developer
- **ì‘ì—… ë°©ì‹**: AI-Only

---

## ğŸ¯ ì‘ì—… ëª©í‘œ

Mock APIë¥¼ Supabase ì—°ë™ Real APIë¡œ ì „í™˜í•˜ì—¬ ì‹¤ì œ AI í‰ê°€ ë°ì´í„° ì¡°íšŒ ê¸°ëŠ¥ êµ¬í˜„

---

## ğŸ”§ ì‚¬ìš© ë„êµ¬

```
[Claude ë„êµ¬]
Read, Edit, Write, Grep, Glob, Bash

[ê¸°ìˆ  ìŠ¤íƒ]
TypeScript, Next.js API Routes, Supabase, Zod

[ì „ë¬¸ ìŠ¤í‚¬]
api-builder, api-test
```

**ë„êµ¬ ì„¤ëª…**:
- **Claude ë„êµ¬**: Claude Codeì˜ ê¸°ë³¸ ê¸°ëŠ¥ (Read, Write, Edit, Bash, Glob, Grep ë“±)
- **ê¸°ìˆ  ìŠ¤íƒ**: í”„ë¡œì íŠ¸ì— ì‚¬ìš©ë˜ëŠ” í”„ë ˆì„ì›Œí¬ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬
- **ì „ë¬¸ ìŠ¤í‚¬**: Anthropic ë¹ŒíŠ¸ì¸ ìŠ¤í‚¬ (.claude/skills/*.md ì°¸ì¡°)

## ğŸ”— ì˜ì¡´ì„± ì •ë³´

**ì˜ì¡´ì„± ì²´ì¸**: P2D1, P3BA1, P3BA2

ì´ ì‘ì—…ì„ ì‹œì‘í•˜ê¸° ì „ì— ë‹¤ìŒ ì‘ì—…ì´ ì™„ë£Œë˜ì–´ì•¼ í•©ë‹ˆë‹¤:
- P2D1: Supabase ìŠ¤í‚¤ë§ˆ êµ¬ì¶• (ai_evaluations í…Œì´ë¸”)
- P3BA1: ì¸ì¦ API (ì‚¬ìš©ì ì¸ì¦)
- P3BA2: ì •ì¹˜ì¸ API (ì •ì¹˜ì¸ ë°ì´í„°)

---

## ğŸ“¦ ê¸°ëŒ€ ê²°ê³¼ë¬¼

- `src/app/api/politicians/[id]/evaluation/route.ts` (Mock â†’ Real êµì²´)
- `src/app/api/evaluations/[evaluationId]/route.ts` (ê°œë³„ í‰ê°€ ì¡°íšŒ)
- `src/app/api/evaluations/history/route.ts` (í‰ê°€ ì´ë ¥ ì¡°íšŒ)

**êµ¬í˜„í•´ì•¼ í•  ì„¸ë¶€ í•­ëª©**:

1. **Mock ì½”ë“œ ì œê±° ë° Real API êµ¬í˜„**
   - ê¸°ì¡´ Mock ì‘ë‹µ ì œê±°
   - Supabase í´ë¼ì´ì–¸íŠ¸ ì—°ê²°
   - `ai_evaluations` í…Œì´ë¸” ì¡°íšŒ

2. **ì •ì¹˜ì¸ë³„ AI í‰ê°€ ì¡°íšŒ**
   - 5ê°œ AI ëª¨ë¸ í‰ê°€ ë°ì´í„° (Claude, ChatGPT, Gemini, Grok, Perplexity)
   - 10ê°œ í‰ê°€ ê¸°ì¤€ë³„ ì ìˆ˜ ë° ê·¼ê±°
   - ì¢…í•© ì ìˆ˜ ë° ë“±ê¸‰ ê³„ì‚°

3. **í‰ê°€ ì´ë ¥ ì¡°íšŒ**
   - ì‹œê³„ì—´ ë°ì´í„° ì¡°íšŒ
   - ì ìˆ˜ ë³€í™” ì¶”ì´
   - ìºì‹± ì „ëµ (5ë¶„)

4. **ì—ëŸ¬ ì²˜ë¦¬ ë° ê²€ì¦**
   - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì •ì¹˜ì¸ ì²˜ë¦¬
   - í‰ê°€ ë°ì´í„° ì—†ìŒ ì²˜ë¦¬
   - RLS ì •ì±… ì ìš© í™•ì¸

5. **ì„±ëŠ¥ ìµœì í™”**
   - ì¸ë±ìŠ¤ í™œìš© (politician_id, created_at)
   - ìºì‹± ì „ëµ
   - ë³‘ë ¬ ì¿¼ë¦¬

---

## ğŸ“ ì‘ì—… ì§€ì‹œì‚¬í•­

### 1. ì¤€ë¹„ ë‹¨ê³„

- í”„ë¡œì íŠ¸ ë£¨íŠ¸: `Developement_Real_PoliticianFinder/1_Frontend`
- í˜„ì¬ Mock API íŒŒì¼ í™•ì¸: `src/app/api/politicians/[id]/evaluation/route.ts`
- DB ìŠ¤í‚¤ë§ˆ í™•ì¸: `0-4_Database/Supabase/migrations/011_create_ai_evaluations_table.sql`
- ì˜ì¡´ì„± ì‘ì—… ì™„ë£Œ í™•ì¸: P2D1, P3BA1, P3BA2

### 2. êµ¬í˜„ ë‹¨ê³„

**2.1 ì •ì¹˜ì¸ë³„ AI í‰ê°€ ì¡°íšŒ API**

```typescript
// src/app/api/politicians/[id]/evaluation/route.ts
import { createClient } from '@/lib/supabase/server'
import { NextRequest, NextResponse } from 'next/server'

export async function GET(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  const supabase = createClient()
  const politicianId = params.id

  // 1. ìµœì‹  í‰ê°€ ë°ì´í„° ì¡°íšŒ
  const { data: evaluations, error } = await supabase
    .from('ai_evaluations')
    .select('*')
    .eq('politician_id', politicianId)
    .order('created_at', { ascending: false })
    .limit(1)

  // 2. ì‘ë‹µ í¬ë§· ë³€í™˜
  // 3. ì—ëŸ¬ ì²˜ë¦¬
}
```

**2.2 ê°œë³„ í‰ê°€ ì¡°íšŒ API**

```typescript
// src/app/api/evaluations/[evaluationId]/route.ts
// íŠ¹ì • í‰ê°€ IDë¡œ ìƒì„¸ ì¡°íšŒ
```

**2.3 í‰ê°€ ì´ë ¥ ì¡°íšŒ API**

```typescript
// src/app/api/evaluations/history/route.ts
// ì‹œê³„ì—´ ë°ì´í„° ì¡°íšŒ (ìµœê·¼ 30ì¼)
```

### 3. ê²€ì¦ ë‹¨ê³„

- íƒ€ì… ì²´í¬: `npm run type-check`
- ë¹Œë“œ: `npm run build`
- API í…ŒìŠ¤íŠ¸: Thunder Client ë˜ëŠ” Postman
- RLS ì •ì±… í™•ì¸

### 4. ì™„ë£Œ ë‹¨ê³„

- ìƒì„±/ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡ í™•ì¸
- PROJECT GRID ì—…ë°ì´íŠ¸ (ìƒì„±ëœ íŒŒì¼, ì‘ì—… ì‹œê°„, ìƒíƒœ)
- ë‹¤ìŒ ì‘ì—… (P3BA12) ì¤€ë¹„

---

## âœ… ì™„ë£Œ ê¸°ì¤€

- [ ] AI í‰ê°€ ì¡°íšŒ APIê°€ ì‹¤ì œ Supabase ë°ì´í„°ë¥¼ ë°˜í™˜í•¨
- [ ] Mock ì½”ë“œê°€ ì™„ì „íˆ ì œê±°ë¨
- [ ] 5ê°œ AI ëª¨ë¸ í‰ê°€ ë°ì´í„° ì •ìƒ ì¡°íšŒ
- [ ] 10ê°œ í‰ê°€ ê¸°ì¤€ë³„ ì ìˆ˜ ë° ê·¼ê±° ì •ìƒ ì¡°íšŒ
- [ ] í‰ê°€ ì´ë ¥ ì‹œê³„ì—´ ë°ì´í„° ì •ìƒ ì¡°íšŒ
- [ ] TypeScript íƒ€ì… ì²´í¬ í†µê³¼
- [ ] Next.js ë¹Œë“œ ì„±ê³µ
- [ ] RLS ì •ì±… ì ìš© í™•ì¸
- [ ] ì—ëŸ¬ ì¼€ì´ìŠ¤ ì²˜ë¦¬ ì™„ë£Œ
- [ ] PROJECT GRID ìƒíƒœ ì—…ë°ì´íŠ¸ ì™„ë£Œ

---

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì°¸ê³ 

```sql
-- ai_evaluations í…Œì´ë¸”
CREATE TABLE ai_evaluations (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  politician_id TEXT (8-char hex) NOT NULL REFERENCES politicians(id),
  evaluator TEXT NOT NULL, -- 'claude', 'chatgpt', 'gemini', 'grok', 'perplexity'
  overall_score INTEGER NOT NULL,
  grade TEXT NOT NULL, -- 'Mugunghwa', 'Rose', 'Maple', 'Orchid', 'Chrysanthemum'

  -- 10ê°œ í‰ê°€ ê¸°ì¤€ (ê° 0-100ì )
  integrity_score INTEGER,
  expertise_score INTEGER,
  communication_score INTEGER,
  leadership_score INTEGER,
  transparency_score INTEGER,
  responsiveness_score INTEGER,
  innovation_score INTEGER,
  collaboration_score INTEGER,
  constituency_service_score INTEGER,
  policy_impact_score INTEGER,

  -- ê·¼ê±° (ê° ê¸°ì¤€ë³„)
  integrity_evidence TEXT,
  expertise_evidence TEXT,
  communication_evidence TEXT,
  leadership_evidence TEXT,
  transparency_evidence TEXT,
  responsiveness_evidence TEXT,
  innovation_evidence TEXT,
  collaboration_evidence TEXT,
  constituency_service_evidence TEXT,
  policy_impact_evidence TEXT,

  report_url TEXT, -- PDF ë¦¬í¬íŠ¸ URL (ì¶”í›„ êµ¬í˜„)
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_ai_evaluations_politician_id ON ai_evaluations(politician_id);
CREATE INDEX idx_ai_evaluations_created_at ON ai_evaluations(created_at);
```

---

**ì‘ì—…ì§€ì‹œì„œ ìƒì„±ì¼**: 2025-11-09
**PROJECT GRID Version**: v4.2
