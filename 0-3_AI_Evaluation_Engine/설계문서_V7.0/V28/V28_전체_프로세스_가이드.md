# V28 전체 프로세스 가이드

**버전**: V28
**최종 업데이트**: 2026-01-09

---

## 핵심 변경사항 (V27 → V28)

| 항목 | V27 | V28 |
|------|-----|-----|
| 테이블명 | collected_data_v27 | **collected_data_v28** |
| PUBLIC 기간 | 1년 | **2년** |
| 수집/평가 | 통합 | **분리 (다른 세션)** |
| Grok 모델 | grok-3-fast | **grok-4-fast** |

---

## 1. 수집 규칙

### 1.1 출처 비율 (필수!)

```
카테고리당 50개 = OFFICIAL 25개 (50%) + PUBLIC 25개 (50%)

Phase 1 (부정 주제 10개 = 20%):
├── OFFICIAL 부정 5개
└── PUBLIC 부정 5개

Phase 2 (자유 평가 40개 = 80%):
├── OFFICIAL 자유 20개
└── PUBLIC 자유 20개
```

### 1.2 기간 제한

| 출처 유형 | 기간 | 예시 (2026-01-09 기준) |
|----------|------|----------------------|
| OFFICIAL | 최근 4년 | 2022-01-09 ~ 2026-01-09 |
| PUBLIC | 최근 2년 | 2024-01-09 ~ 2026-01-09 |

### 1.3 부정 주제 20% 의무화

- 각 카테고리의 첫 10개는 **반드시 부정적 내용**만 수집
- 논란, 비판, 스캔들, 의혹, 실패, 문제점 등
- 긍정적 내용은 Phase 2에서 자유롭게 수집

---

## 2. AI 모델 설정

| AI | 모델명 | 환경변수 |
|----|--------|----------|
| Claude | claude-3-5-haiku-20241022 | ANTHROPIC_API_KEY |
| ChatGPT | gpt-4o-mini | OPENAI_API_KEY |
| Grok | **grok-4-fast** | XAI_API_KEY |
| Gemini | gemini-2.0-flash | GEMINI_API_KEY |

---

## 3. 정치인 정보 제공

### 3.1 기본 프로필 (DB에서 조회)

```
- 이름, 신분, 직책, 정당, 지역, 성별
- politicians 테이블에서 자동 조회
```

### 3.2 특별 지시사항 (md 파일에서 읽기)

**파일 위치**:
```
설계문서_V7.0/instructions_v27/1_politicians/{정치인명}.md
```

**수집 시 포함 항목**:
- 수집 시 주의점
- 알려진 논란/이슈
- 알려진 성과
- 출처 힌트

**평가 시 포함 항목**:
- 평가 시 주의점
- 알려진 논란/이슈
- 알려진 성과

---

## 4. 수집/평가 세션 분리

### 핵심 원칙
```
수집 세션 ≠ 평가 세션

- 같은 AI지만 다른 API 호출(세션)에서 평가
- 수집 시점의 컨텍스트 없이 객관적으로 평가
```

### 프로세스
```
[1단계] 수집 (collect_v28.py)
- 각 AI가 rating 없이 데이터만 수집
- DB에 rating=NULL로 저장

[2단계] 평가 (evaluate_v28.py)
- 다른 세션에서 rating 부여
- rating 컬럼 업데이트

[3단계] 점수 계산 (calculate_v28_scores.py)
- rating 기반 점수 계산
```

---

## 5. 스크립트 사용법

### 5.1 수집

```bash
# 단일 AI
python collect_v28.py --politician_id=17270f25 --politician_name="정원오" --ai=Claude

# 전체 AI (순차)
python collect_v28.py --politician_id=17270f25 --politician_name="정원오"

# 전체 AI (병렬)
python collect_v28.py --politician_id=17270f25 --politician_name="정원오" --parallel
```

### 5.2 평가

```bash
# 단일 AI
python evaluate_v28.py --politician_id=17270f25 --ai=Claude

# 전체 AI
python evaluate_v28.py --politician_id=17270f25 --all
```

### 5.3 점수 계산

```bash
python calculate_v28_scores.py --politician_id=17270f25
```

---

## 6. DB 테이블

### V28 테이블명

| 용도 | 테이블명 |
|------|----------|
| 수집 데이터 | collected_data_v28 |
| 카테고리 점수 | ai_category_scores_v28 |
| 최종 점수 | ai_final_scores_v28 |
| 평가 기록 | ai_evaluations_v28 |

### rating 저장 규칙

```
등급 | 점수
-----|-----
A    | +8
B    | +6
C    | +4
D    | +2
E    | -2
F    | -4
G    | -6
H    | -8
```

- rating은 **알파벳 그대로 저장** (A~H)
- 점수 변환은 계산 시 수행

---

## 7. 점수 계산 공식

```python
PRIOR = 6.0
COEFFICIENT = 0.5

# 카테고리 점수 (20~100점)
category_score = (PRIOR + avg_rating * COEFFICIENT) * 10

# 최종 점수 (200~1000점)
final_score = min(sum(10개 카테고리), 1000)
```

---

## 8. 정치인별 지시사항 템플릿

### 파일명: `{정치인명}.md`

```markdown
# {정치인명} - 정치인 정보 V28

## 기본 정보

| 필드 | 값 |
|------|-----|
| **politician_id** | {8자리 hex} |
| **성명** | {이름} |
| **현 직책** | {직책} |
| **소속 정당** | {정당} |
| **지역** | {지역} |

## 특별 지시사항

### 수집 시 주의점
- {주의사항 1}
- {주의사항 2}

### 평가 시 주의점
- {평가 고려사항}

### 알려진 논란/이슈
- {논란 1}: {설명}

### 알려진 성과
- {성과 1}: {설명}

## 출처 힌트

### OFFICIAL 출처
- {기관명}: {URL}

### PUBLIC 출처
- {언론/SNS}: {URL}
```

---

## 9. 체크리스트

### 수집 전
- [ ] 4개 API 키 설정 (.env)
- [ ] 정치인 politicians 테이블 등록 확인
- [ ] 정치인별 지시사항 md 파일 준비

### 수집 중
- [ ] OFFICIAL 50% / PUBLIC 50% 비율 확인
- [ ] 부정 주제 20% 수집 확인
- [ ] 기간 제한 준수 확인

### 평가 전
- [ ] 수집 완료 확인 (500개/AI)
- [ ] rating=NULL 데이터 존재 확인

### 점수 계산 전
- [ ] 모든 AI 평가 완료 확인
- [ ] rating 값 유효성 확인 (A~H)

---

## 10. 현재 완료된 정치인

| 정치인 | ID | 상태 |
|--------|-----|------|
| 정원오 | 17270f25 | ✅ 수집 완료 (2000개) |
| 이준석 | (확인필요) | ✅ 수집 완료 (2000개) |
| 오세훈 | 62e7b453 | ✅ 수집 완료 (2000개) |

---

## 11. 대기 중인 정치인 (7명)

1. 한동훈
2. 박주민
3. 김민석
4. 신동욱
5. 나경원
6. 조은희
7. 전현희

---

**문서 끝**
